{"ast":null,"code":"import _objectSpread from\"C:\\\\webgis\\\\newfold\\\\dapp-project\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";import _asyncToGenerator from\"C:\\\\webgis\\\\newfold\\\\dapp-project\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\webgis\\\\newfold\\\\dapp-project\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\webgis\\\\newfold\\\\dapp-project\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useCallback,useEffect,useRef,useState}from\"react\";import{useMoralis,useMoralisWeb3Api}from\"react-moralis\";import{getEllipsisTxt}from\"../helpers/formatters\";import Blockie from\"./Blockie\";import{Input}from\"antd\";import{SearchOutlined}from\"@ant-design/icons\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AddressInput(props){var _web3$eth2;var input=useRef(null);var _useMoralis=useMoralis(),web3=_useMoralis.web3;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),address=_useState2[0],setAddress=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),validatedAddress=_useState4[0],setValidatedAddress=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isDomain=_useState6[0],setIsDomain=_useState6[1];var _useMoralisWeb3Api=useMoralisWeb3Api(),resolveDomain=_useMoralisWeb3Api.resolve.resolveDomain;// eslint-disable-next-line react-hooks/exhaustive-deps\nuseEffect(function(){if(validatedAddress)props.onChange(isDomain?validatedAddress:address);},[props,validatedAddress,isDomain,address]);var updateAddress=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(value){var processPromise,_web3$eth,_web3$eth$ens;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setAddress(value);if(isSupportedDomain(value)){processPromise=function processPromise(promise){promise.then(function(addr){setValidatedAddress(addr);setIsDomain(true);}).catch(function(){setValidatedAddress(\"\");});};if(value.endsWith(\".eth\")){processPromise(web3===null||web3===void 0?void 0:(_web3$eth=web3.eth)===null||_web3$eth===void 0?void 0:(_web3$eth$ens=_web3$eth.ens)===null||_web3$eth$ens===void 0?void 0:_web3$eth$ens.getAddress(value));}else{processPromise(resolveDomain({domain:value}).then(function(r){return r===null||r===void 0?void 0:r.address;}));}}else if(value.length===42){setValidatedAddress(getEllipsisTxt(value,10));setIsDomain(false);}else{setValidatedAddress(\"\");setIsDomain(false);}case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),[resolveDomain,web3===null||web3===void 0?void 0:(_web3$eth2=web3.eth)===null||_web3$eth2===void 0?void 0:_web3$eth2.ens]);var Cross=function Cross(){return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"22\",height:\"22\",viewBox:\"0 0 24 24\",strokeWidth:\"2\",stroke:\"#E33132\",fill:\"none\",strokeLinecap:\"round\",strokeLinejoin:\"round\",onClick:function onClick(){setValidatedAddress(\"\");setIsDomain(false);setTimeout(function(){input.current.focus();});},style:{cursor:\"pointer\"},children:[/*#__PURE__*/_jsx(\"path\",{stroke:\"none\",d:\"M0 0h24v24H0z\",fill:\"none\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"18\",y1:\"6\",x2:\"6\",y2:\"18\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"6\",y1:\"6\",x2:\"18\",y2:\"18\"})]});};return/*#__PURE__*/_jsx(Input,{ref:input,size:\"large\",placeholder:props.placeholder?props.placeholder:\"Public address\",prefix:isDomain||address.length===42?/*#__PURE__*/_jsx(Blockie,{address:(isDomain?validatedAddress:address).toLowerCase(),size:8,scale:3}):/*#__PURE__*/_jsx(SearchOutlined,{}),suffix:validatedAddress&&/*#__PURE__*/_jsx(Cross,{}),autoFocus:props.autoFocus,value:isDomain?\"\".concat(address,\" (\").concat(getEllipsisTxt(validatedAddress),\")\"):validatedAddress||address,onChange:function onChange(e){updateAddress(e.target.value);},disabled:validatedAddress,style:validatedAddress?_objectSpread(_objectSpread({},props===null||props===void 0?void 0:props.style),{},{border:\"1px solid rgb(33, 191, 150)\"}):_objectSpread({},props===null||props===void 0?void 0:props.style)});}function isSupportedDomain(domain){return[\".eth\",\".crypto\",\".coin\",\".wallet\",\".bitcoin\",\".x\",\".888\",\".nft\",\".dao\",\".blockchain\"].some(function(tld){return domain.endsWith(tld);});}export default AddressInput;","map":{"version":3,"sources":["C:/webgis/newfold/dapp-project/src/components/AddressInput.jsx"],"names":["useCallback","useEffect","useRef","useState","useMoralis","useMoralisWeb3Api","getEllipsisTxt","Blockie","Input","SearchOutlined","AddressInput","props","input","web3","address","setAddress","validatedAddress","setValidatedAddress","isDomain","setIsDomain","resolveDomain","resolve","onChange","updateAddress","value","isSupportedDomain","processPromise","promise","then","addr","catch","endsWith","eth","ens","getAddress","domain","r","length","Cross","setTimeout","current","focus","cursor","placeholder","toLowerCase","autoFocus","e","target","style","border","some","tld"],"mappings":"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","sourcesContent":["import { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport { useMoralis, useMoralisWeb3Api } from \"react-moralis\";\r\nimport { getEllipsisTxt } from \"../helpers/formatters\";\r\nimport Blockie from \"./Blockie\";\r\nimport { Input } from \"antd\";\r\nimport { SearchOutlined } from \"@ant-design/icons\";\r\n\r\nfunction AddressInput(props) {\r\n  const input = useRef(null);\r\n  const { web3 } = useMoralis();\r\n  const [address, setAddress] = useState(\"\");\r\n  const [validatedAddress, setValidatedAddress] = useState(\"\");\r\n  const [isDomain, setIsDomain] = useState(false);\r\n  const {\r\n    resolve: { resolveDomain },\r\n  } = useMoralisWeb3Api();\r\n\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  useEffect(() => {\r\n    if (validatedAddress) props.onChange(isDomain ? validatedAddress : address);\r\n  }, [props, validatedAddress, isDomain, address]);\r\n\r\n  const updateAddress = useCallback(\r\n    async (value) => {\r\n      setAddress(value);\r\n      if (isSupportedDomain(value)) {\r\n        const processPromise = function (promise) {\r\n          promise\r\n            .then((addr) => {\r\n              setValidatedAddress(addr);\r\n              setIsDomain(true);\r\n            })\r\n            .catch(() => {\r\n              setValidatedAddress(\"\");\r\n            });\r\n        };\r\n        if (value.endsWith(\".eth\")) {\r\n          processPromise(web3?.eth?.ens?.getAddress(value));\r\n        } else {\r\n          processPromise(\r\n            resolveDomain({\r\n              domain: value,\r\n            }).then((r) => r?.address),\r\n          );\r\n        }\r\n      } else if (value.length === 42) {\r\n        setValidatedAddress(getEllipsisTxt(value, 10));\r\n        setIsDomain(false);\r\n      } else {\r\n        setValidatedAddress(\"\");\r\n        setIsDomain(false);\r\n      }\r\n    },\r\n    [resolveDomain, web3?.eth?.ens],\r\n  );\r\n\r\n  const Cross = () => (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"22\"\r\n      height=\"22\"\r\n      viewBox=\"0 0 24 24\"\r\n      strokeWidth=\"2\"\r\n      stroke=\"#E33132\"\r\n      fill=\"none\"\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      onClick={() => {\r\n        setValidatedAddress(\"\");\r\n        setIsDomain(false);\r\n        setTimeout(function () {\r\n          input.current.focus();\r\n        });\r\n      }}\r\n      style={{ cursor: \"pointer\" }}\r\n    >\r\n      <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" />\r\n      <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\r\n      <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n    </svg>\r\n  );\r\n\r\n  return (\r\n    <Input\r\n      ref={input}\r\n      size=\"large\"\r\n      placeholder={props.placeholder ? props.placeholder : \"Public address\"}\r\n      prefix={\r\n        isDomain || address.length === 42 ? (\r\n          <Blockie\r\n            address={(isDomain ? validatedAddress : address).toLowerCase()}\r\n            size={8}\r\n            scale={3}\r\n          />\r\n        ) : (\r\n          <SearchOutlined />\r\n        )\r\n      }\r\n      suffix={validatedAddress && <Cross />}\r\n      autoFocus={props.autoFocus}\r\n      value={\r\n        isDomain\r\n          ? `${address} (${getEllipsisTxt(validatedAddress)})`\r\n          : validatedAddress || address\r\n      }\r\n      onChange={(e) => {\r\n        updateAddress(e.target.value);\r\n      }}\r\n      disabled={validatedAddress}\r\n      style={\r\n        validatedAddress\r\n          ? { ...props?.style, border: \"1px solid rgb(33, 191, 150)\" }\r\n          : { ...props?.style }\r\n      }\r\n    />\r\n  );\r\n}\r\n\r\nfunction isSupportedDomain(domain) {\r\n  return [\r\n    \".eth\",\r\n    \".crypto\",\r\n    \".coin\",\r\n    \".wallet\",\r\n    \".bitcoin\",\r\n    \".x\",\r\n    \".888\",\r\n    \".nft\",\r\n    \".dao\",\r\n    \".blockchain\",\r\n  ].some((tld) => domain.endsWith(tld));\r\n}\r\n\r\nexport default AddressInput;\r\n"]},"metadata":{},"sourceType":"module"}